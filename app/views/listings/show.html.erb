<div class="flex flex-wrap my-4 lg:px-24">
  <div class="lg:w-1/4 w-full md:p-4">
    <div class="bg-gray-200 lg:flex lg:justify-center">
    <div class="bg-white lg:flex lg:shadow-lg lg:rounded-lg w-full">
    <div class="flex flex-col w-full">
      <div class="px-4 py-5 border-b border-gray-200 sm:px-6">
        <h3 class="text-lg leading-6 font-medium text-gray-900">
          <%= @listing.title %>
        </h3>
        <p class="mt-1 max-w-2xl text-sm leading-5 text-gray-500">
          <%= @listing.properties.first.address_city %>, <%= @listing.properties.first.address_state %>
        </p>

      </div>
      <div>
        <dl>
          <div class="bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-2 sm:gap-4 sm:px-6">
            <dt class="text-sm leading-5 font-medium text-gray-500">
              Brokerage Company
            </dt>
            <dd class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-1">
              <%= @listing.account.name %>
            </dd>
          </div>
          <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-2 sm:gap-4 sm:px-6">
            <dt class="text-sm leading-5 font-medium text-gray-500">
              Investment Type
            </dt>
            <dd class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-1">
              <%= @listing.investment_type %>
            </dd>
          </div>
          <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-2 sm:gap-4 sm:px-6">
            <dt class="text-sm leading-5 font-medium text-gray-500">
              Asset Type
            </dt>
            <dd class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-1">
              <%= asset_types(@listing).join(", ") %>
            </dd>
          </div>
          <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-2 sm:gap-4 sm:px-6">
            <dt class="text-sm leading-5 font-medium text-gray-500">
              Asset Class
            </dt>
            <dd class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-1">
              <%= asset_classes(@listing).join(", ") %>
              
            </dd>
          </div>
          
        </dl>

      </div>
    </div>
  </div>
</div>

<% if user_signed_in? %>
  <% if current_account == @listing.account %>
      <div class="dropdown">
          <div class="menu-btn">
            <div class="btn btn-tertiary no-underline mt-6 p-6 w-full justify-center" id="action-menu" aria-label="Action menu" aria-haspopup="true">Listing Actions</div>
          </div>
          <!--
            Profile dropdown panel, show/hide based on dropdown state.

            Entering: "transition ease-out duration-100"
              From: "transform opacity-0 scale-95"
              To: "transform opacity-100 scale-100"
            Leaving: "transition ease-in duration-75"
              From: "transform opacity-100 scale-100"
              To: "transform opacity-0 scale-95"
          -->
          <div class="menu hidden origin-top-right right-0 w-full rounded-md shadow-lg">
            <div class="py-1 rounded-md bg-white shadow-xs" role="menu" aria-orientation="vertical" aria-labelledby="user-menu">
              <%= link_to 'Edit', edit_listing_path(@listing), class: 'block px-4 py-2 text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out' %>
    
              <%= link_to 'Invite A User', new_listing_listing_invitation_path(@listing), class: 'block px-4 py-2 text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out' %>

              <%= render 'shared/events', model: @listing %>
            </div>
          </div>
 
        </div>


  <% elsif current_user.memberships.find_by(listing_id: @listing.id) && !current_user.nda_signings.find_by(listing_id: @listing.id) %>
    <%= link_to 'Sign Agreement', new_listing_nda_signing_path(@listing), class: "mt-6 btn btn-primary w-full justify-center p-6" %>
  <% elsif !current_user.memberships.find_by(listing_id: @listing.id) %>
    <%= link_to 'Join Listing', listing_join_path(@listing, user_id: current_user.id), method: :post, class: "mt-6 btn btn-primary w-full justify-center p-6" %>
  <% end %>
<% else %>
  <%= link_to 'Sign In to Join', new_user_session_path, class: "mt-6 btn btn-primary w-full justify-center p-6" %>
<% end %>
</div>

  <div class="lg:w-3/4 w-full md:p-4">
      <div class="bg-gray-200 lg:flex lg:justify-center">
          <div class="bg-white lg:flex lg:shadow-lg lg:rounded-lg w-full">
              <div class="lg:w-1/2">
                  <div class="h-64 bg-cover lg:rounded-lg lg:h-full" style="background-image: url(<%= @listing.listing_images.first.image_url %>)"></div>
              </div>

              <div class="py-12 px-12 max-w-xl lg:max-w-5xl lg:w-1/2">
                  <h2 class="text-3xl text-gray-800 font-bold mb-2">Listing <span class="text-indigo-600">Highlights</span></h2>


                <div>
                  <dl class="flex">
                    <div class="w-1/2 bg-white py-5 sm:grid sm:grid-cols-3">
                      <dt class="leading-5 font-medium text-gray-500">
                        Price
                      </dt>
                      <dd class="md:ml-4 mt-1 leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                        <%= number_to_currency(@listing.price, :unit => "$", precision: 0) %>
                      </dd>
                    </div>
                    <div class="w-1/2 bg-white py-5 sm:grid sm:grid-cols-3">
                      <dt class="leading-5 font-medium text-gray-500">
                        SF
                      </dt>
                      <dd class="md:ml-4 mt-1 leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                        <%= total_sf(@listing) %>
                      </dd>
                    </div>

                  </dl>
                  <dl class="flex">
                    <div class="w-1/2 bg-gray-50 py-5 sm:grid sm:grid-cols-3">
                      <dt class="leading-5 font-medium text-gray-500">
                        Buildings
                      </dt>
                      <dd class="md:ml-4 mt-1 leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                        <%= @listing.properties.count %>
                      </dd>
                    </div>
                    <div class="w-1/2 bg-gray-50 py-5 sm:grid sm:grid-cols-3">
                      <dt class="leading-5 font-medium text-gray-500">
                        Price / SF
                      </dt>
                      <dd class="md:ml-4 mt-1 leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
                        <%= number_to_currency(sf_price(@listing), :unit => "$") %>
                      </dd>
                    </div>
                    
                  </dl>
                </div>

                  <p class="mt-2 text-gray-600">
                    <% if @listing.description.to_s.length > 250 %>
                      <%= truncate(strip_tags(@listing.description.to_s), length: 250) %>
                      <%= link_to 'read more', '', class: "read-more-#{@listing.id}" %>
                      <script>
                        $('.read-more-<%= @listing.id %>').on('click', function(e) {
                          e.preventDefault()
                          $('#desc-rm').removeClass("hidden")
                        })

                        $('#desc-close').on('click', function(e) {
                          e.preventDefault()
                          $('#desc-rm').addClass("hidden")
                        })
                      </script>
                    <% else %>
                      <%= @listing.description %>
                    <% end %>
                  <p>
              </div>

          </div>
       </div>


       <div id="desc-rm" class="hidden">
          <div class="bg-gray-200 lg:pt-12 lg:flex lg:justify-center">
              <div class="bg-white lg:flex lg:shadow-lg lg:rounded-lg w-full">
                <div class="flex flex-col w-full">
                  <div class="px-4 py-2 border-b border-gray-200 sm:px-6 text-right">
                    <a href="" id="desc-close" class="text-sm leading-6 font-medium text-red">  
                      close x 
                    </a>
                  </div>
                  <div class="py-6 px-12 w-full">
                      <p class="text-gray-600">              
                          <%= @listing.description %>
                      </p>
                  </div>
                </div>
              </div>
            </div>
          </div>
<div>
  <div class="bg-gray-200 lg:pt-12 lg:flex lg:justify-center">
    <div class="bg-white lg:flex lg:shadow-lg lg:rounded-lg w-full">
      <div class="flex flex-col w-full">
        <div class="-my-2 py-2 overflow-x-auto sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8">
          <div class="align-middle inline-block min-w-full shadow overflow-hidden sm:rounded-lg border-b border-gray-200">
            <table class="min-w-full divide-y divide-gray-200">
              <thead>
                <tr>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Property
                  </th>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Type
                  </th>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Asset Class
                  </th>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Square Footage
                  </th>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Floors
                  </th>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Units
                  </th>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Buildings
                  </th>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Land Area
                  </th>
                  <th class="px-6 py-3 border-b border-gray-200 bg-gray-50 text-left text-xs leading-4 font-medium text-gray-500 uppercase tracking-wider">
                    Zoning
                  </th>
                </tr>
              </thead>
              <tbody class="bg-white divide-y divide-gray-200">
                <% @listing.properties.each do |property| %>
                <tr>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">
                    <div class="flex items-center">
                      <div class="ml-4">
                        <div class="text-sm leading-5 font-medium text-gray-900">
                          <%= property.address1 %>
                        </div>
                        <div class="text-sm leading-5 text-gray-500">
                          <%= property.address_city %>, <%= property.address_state %> <%= property.address_zip %>
                        </div>
                      </div>
                    </div>
                  </td>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">
                    <div class="text-sm leading-5 text-gray-900"><%= property.primary_type %></div>
                    <div class="text-sm leading-5 text-gray-500"><%= property.secondary_type %></div>
                  </td>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">
                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                      <%= property.asset_class %>
                    </span>
                  </td>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200 text-sm leading-5 text-gray-500">
                    <%= property.sf.to_s(:delimited) %>
                  </td>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200 text-sm leading-5 text-gray-500">
                    <%= property.floors %>
                  </td>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200 text-sm leading-5 text-gray-500">
                    <%= property.units %>
                  </td>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200 text-sm leading-5 text-gray-500">
                    <%= property.buildings %>
                  </td>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200 text-sm leading-5 text-gray-500">
                    <%= property.land_area %>
                  </td>
                  <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200 text-sm leading-5 text-gray-500">
                    <%= property.zoning %>
                  </td>
                </tr>
                <% end %>
                <% if @listing.properties.count > 1 %>
                  
                  <tr>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200">
                      <div class="flex items-center">
                        <div class="ml-4">
                          <div class="text-sm leading-5 font-medium text-gray-900">
                            Total
                          </div>
                        </div>
                      </div>
                    </td>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200">
                      -
                    </td>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200">
                      -
                    </td>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200 text-sm leading-5 text-gray-500">
                      <%= total_sf(@listing) %>
                    </td>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200 text-sm leading-5 text-gray-500">
                      -
                    </td>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200 text-sm leading-5 text-gray-500">
                      <%= total_units(@listing) %>
                    </td>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200 text-sm leading-5 text-gray-500">
                      <%= @listing.properties.count %>
                    </td>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200 text-sm leading-5 text-gray-500">
                      <%= total_land_area(@listing) %>
                    </td>
                    <td class="px-6 py-4 whitespace-no-wrap bg-gray-50 border-b border-gray-200 text-sm leading-5 text-gray-500">
                      -
                    </td>
                  </tr>
                <% end %>
                <!-- More rows... -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
</div></div></div>

<div>
      <div class="bg-gray-200 lg:pt-12 lg:flex lg:justify-center">
          <div class="bg-white lg:flex lg:shadow-lg lg:rounded-lg w-full">
      <div class="flex flex-col w-full">
      <div class="px-4 py-5 border-b border-gray-200 sm:px-6">
        <h3 class="text-lg leading-6 font-medium text-gray-900">
          Documents
        </h3>
        <p class="mt-1 max-w-2xl text-sm leading-5 text-gray-500">
          Marketing and financial documents.
        </p>
      </div>
      <div>
        <dl>
          <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt class="text-sm leading-5 font-medium text-gray-500">
              Public Documents
            </dt>
            <dd class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
              <ul class="border border-gray-200 rounded-md">
                <% @listing.listing_documents.each do |doc| %>
                  <li class="pl-3 pr-4 py-3 flex items-center justify-between text-sm leading-5">
                    <div class="w-0 flex-1 flex items-center">
                      <svg class="flex-shrink-0 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z" clip-rule="evenodd" />
                      </svg>
                      <span class="ml-2 flex-1 w-0 truncate">
                        <%= doc.document.original_filename %>
                      </span>
                    </div>
                    <div class="ml-4 flex-shrink-0">
                        <%= link_to"Download", doc.document_url, class: "font-medium text-indigo-600 hover:text-indigo-500 transition duration-150 ease-in-out" %>
                    </div>
                  </li>
                <% end %>
              </ul>
            </dd>
          </div>

          <div class="bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6">
            <dt class="text-sm leading-5 font-medium text-gray-500">
              Secure Documents
            </dt>
            <dd class="mt-1 text-sm leading-5 text-gray-900 sm:mt-0 sm:col-span-2">
              <ul class="border border-gray-200 rounded-md">
                <% @listing.listing_secure_documents.each do |doc| %>
                  <li class="pl-3 pr-4 py-3 flex items-center justify-between text-sm leading-5">
                    <div class="w-0 flex-1 flex items-center">
                      <svg class="flex-shrink-0 h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M8 4a3 3 0 00-3 3v4a5 5 0 0010 0V7a1 1 0 112 0v4a7 7 0 11-14 0V7a5 5 0 0110 0v4a3 3 0 11-6 0V7a1 1 0 012 0v4a1 1 0 102 0V7a3 3 0 00-3-3z" clip-rule="evenodd" />
                      </svg>
                      <span class="ml-2 flex-1 w-0 truncate">
                        <%= doc.secure_document.original_filename %>
                      </span>
                    </div>
                    <div class="ml-4 flex-shrink-0">
                        <% if has_secure_access %>
                          <%= link_to "Download", doc.secure_document_url, class: "font-medium text-indigo-600 hover:text-indigo-500 transition duration-150 ease-in-out" %>
                        <% else %>
                          <p>Request secure access</p>
                        <% end %>
                    </div>
                  </li>
                <% end %>
              </ul>
            </dd>
          </div>

        </dl>
      </div>
    </div>
  </div></div></div>



<div class="bg-gray-200 lg:pt-12 lg:flex lg:justify-center">
          <div class="bg-white lg:flex lg:shadow-lg lg:rounded-lg w-full">

      <div class="py-12 px-12 max-w-xl lg:max-w-5xl lg:w-1/2">
        <h2 class="text-sm title-font text-gray-500 tracking-widest">Capital Science</h2>
        <h1 class="text-gray-900 text-3xl title-font font-medium mb-4">Financials</h1>
        <div class="flex mb-4">
          <a class="flex-grow text-indigo-500 border-b-2 border-indigo-500 py-2 text-lg px-1">Summary</a>
          <a class="flex-grow border-b-2 border-gray-300 py-2 text-lg px-1">Reviews</a>
          <a class="flex-grow border-b-2 border-gray-300 py-2 text-lg px-1">Details</a>
        </div>
        <p class="leading-relaxed mb-4">We've calculated the most common financial metrics.</p>
        <div class="flex border-t border-gray-300 py-2">
          <span class="text-gray-500">Color</span>
          <span class="ml-auto text-gray-900">Blue</span>
        </div>
        <div class="flex border-t border-gray-300 py-2">
          <span class="text-gray-500">Size</span>
          <span class="ml-auto text-gray-900">Medium</span>
        </div>
        <div class="flex border-t border-b mb-6 border-gray-300 py-2">
          <span class="text-gray-500">Quantity</span>
          <span class="ml-auto text-gray-900">4</span>
        </div>
        <div class="flex">
          <span class="title-font font-medium text-2xl text-gray-900">$58.00</span>
          <button class="flex ml-auto text-white bg-indigo-500 border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded">Button</button>
          <button class="rounded-full w-10 h-10 bg-gray-200 p-0 border-0 inline-flex items-center justify-center text-gray-500 ml-4">
            <svg fill="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" class="w-5 h-5" viewBox="0 0 24 24">
              <path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"></path>
            </svg>
          </button>
        </div>
      </div>
      <%= tag.div nil, id: 'map', class: 'lg:w-1/2 w-full lg:h-auto h-64 object-cover object-center rounded', data: { properties: @listing.properties.to_json(methods: [:address]) } %>
    </div>
  </div>





<div>
      <div class="bg-gray-200 lg:py-12 lg:flex lg:justify-center">
          <div class="bg-white lg:flex w-full rounded-lg shadow-lg overflow-hidden">
              <div class="md:flex lg:w-1/2 lg:bg-gray-700 items-center justify-center">
                  <div class="py-6 px-8 md:py-0">
                <h2 class="text-gray-700 text-2xl font-bold md:text-gray-100">Sign Up For Listing Updates</h2>
                <p class="mt-2 text-gray-600 md:text-gray-400">Lorem ipsum dolor sit, amet consectetur adipisicing elit. Consectetur obcaecati odio</p>
            </div>
                  

              </div>
              <div class="py-12 px-6 max-w-xl lg:max-w-5xl lg:w-1/2 flex flex-col rounded-lg overflow-hidden sm:flex-row">
                  <form class="mx-auto">
                      <div class="flex flex-col rounded-lg overflow-hidden sm:flex-row">
                          <input class="py-3 px-4 bg-gray-200 text-gray-800 border-gray-300 border-2 outline-none placeholder-gray-500 focus:bg-gray-200" type="text" name="email" placeholder="Enter your email">
                          <button class="py-3 px-4 bg-gray-700 text-gray-100 font-semibold uppercase hover:bg-gray-600">subscribe</button>
                      </div>
                  </form>
              </div>

          </div>
      </div> 
  </div>

    </div>
</div>




